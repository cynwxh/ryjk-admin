webpackJsonp([26],{"Z+tq":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("kMct"),s=n("EMXe"),o=n("Q338"),l={components:{ElButton:s.a,ElCol:a.a,tabHeader:o.a},name:"createPlan",data:function(){return{planId:null,dose:"",createDate:"",disabled:!1,number:[{value:1},{value:2},{value:4},{value:5}],name:"",date:"",user:{},planList:[{value:1,label:"用药建议"},{value:2,label:"饮食建议"},{value:3,label:"运动建议"},{value:4,label:"戒烟限酒建议"},{value:5,label:"心理建议"},{value:6,label:"康复建议"},{value:7,label:"其他"}],bodySignList:[],slectedBodySignList:[],form:{},personInfo:{}}},created:function(){var e=this.$route.query.planId;this.planId=e,e?(this.disabled=!0,this.getPlanInfo(e)):this.getPlanList(),this.personInfo=JSON.parse(sessionStorage.getItem("personInfo")),this.user=JSON.parse(sessionStorage.getItem("loginUser"))},mounted:function(){this.getBodySignList()},methods:{getPlanInfo:function(e){var t=this;this.$http.get("/api/plan/getPlanDetail?planId="+e).then(function(e){var n=e.data;t.name=n.name,t.dose=n.dose;var a=t.planList;t.planList=n.item.map(function(e,t){return{label:e.detailType,value:a[t].value,content:e.content}}),t.slectedBodySignList=n.monitorItem}).catch(function(e){console.log(e)})},getPlanList:function(){var e=this;this.$http.get("/api/plan/getPlanItem").then(function(t){e.planList=t.data}).catch(function(e){console.log(e)})},getBodySignList:function(){var e=this;this.$http.get("/api/bodySignRecord/getBodySignList").then(function(t){e.bodySignList=t.data}).catch(function(e){console.log(e)})},back:function(){this.$router.go(-1)},onSubmit:function(){var e=this,t=this.planList.map(function(e,t){return{detailType:e.value,content:e.content}}),n={departmentName:this.personInfo.departmentName,id:this.planId?Number(this.planId):null,dose:this.dose||0,createDate:this.createDate||new Date,name:this.name||"",patientId:this.personInfo.id,doctorId:this.user.id,monitorItem:this.slectedBodySignList.join(","),item:t};""!=n.name?""!=n.createDate?""!=n.monitorItem?this.planId?this.$http.post("/api/plan/updatePlan",n).then(function(t){t.data?e.$message({type:"success",message:"修改计划成功",duration:1e3,onClose:function(){e.$router.push({name:"EssentialInfo",params:{selectId:"jhxx"}})}}):e.$message.error("修改计划失败")}).catch(function(e){console.log(e)}):this.$http.post("/api/plan/addPlan",n).then(function(t){t.data?e.$message({type:"success",message:"新增计划成功",duration:1e3,onClose:function(){e.$router.push({name:"EssentialInfo",params:{selectId:"jhxx"}})}}):e.$message.error("新增计划失败")}).catch(function(e){console.log(e)}):this.$$message.warning("请选择必测体征项！"):this.$$message.warning("请选择计划时间！"):this.$$message.warning("请填写计划名称！")},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cp_container"},[n("tab-header",{attrs:{personInfo:e.personInfo}}),e._v(" "),n("el-form",{ref:"form",attrs:{"label-width":"100px"}},[n("h2",[e._v("疾病计划名称")]),e._v(" "),n("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),n("h2",[e._v("疾病计划时间")]),e._v(" "),n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择时间","value-format":"yyyy-MM-dd HH:mm:ss",disabled:e.disabled},model:{value:e.createDate,callback:function(t){e.createDate=t},expression:"createDate"}}),e._v(" "),n("h2",[e._v("管理随访总数")]),e._v(" "),n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dose,callback:function(t){e.dose=t},expression:"dose"}},e._l(e.number,function(e){return n("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1),e._v(" "),n("h2",[e._v("疾病计划分类")]),e._v(" "),n("el-row",e._l(e.planList,function(t,a){return n("el-col",{key:a,attrs:{span:24}},[n("el-form-item",{attrs:{label:t.label}},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入建议"},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"v.content"}})],1)],1)}),1),e._v(" "),n("h2",[e._v("疾病必测体征项")]),e._v(" "),n("el-checkbox-group",{model:{value:e.slectedBodySignList,callback:function(t){e.slectedBodySignList=t},expression:"slectedBodySignList"}},e._l(e.bodySignList,function(t){return n("el-checkbox",{key:t.bodySignId,attrs:{label:t.bodySignId}},[e._v(e._s(t.bodySignName))])}),1),e._v(" "),n("el-button",{staticClass:"submitBtn",staticStyle:{"margin-left":"10px"},on:{click:e.back}},[e._v("取消")]),e._v(" "),n("el-button",{staticClass:"submitBtn",attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("发布")])],1)],1)},staticRenderFns:[]};var c=n("VU/8")(l,i,!1,function(e){n("bu+t")},null,null);t.default=c.exports},"bu+t":function(e,t){}});